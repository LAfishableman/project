# 心脏病发作预测模型

## 问题陈述

本项目的目标是使用监督机器学习模型，根据医疗数据集中的特征（年龄、性别、心率、收缩压、舒张压、血糖、CK-MB 和肌钙蛋白）预测心脏病发作结果（阳性或阴性）。数据集包含患者的记录，带有二进制标签，指示是否发生了心脏病发作。
## 方法

### 数据预处理：

加载并清理数据集，移除异常值（例如，心率 > 200，血糖 > 500）。
将“Result”列转换为二进制（阳性为 1，阴性为 0）。
使用 StandardScaler 对数值特征进行标准化。
### 模型选择：
选择随机森林分类器，因其鲁棒性和处理非线性关系的能力。
通过网格搜索优化超参数（例如，树的数量、最大深度）。


### 评估：

将数据分为 80% 训练集和 20% 测试集，使用分层抽样保持标签比例。
使用准确率、精确率、召回率、F1 分数和 ROC-AUC 评估模型，特别关注召回率以减少假阴性。
使用混淆矩阵、特征重要性图和 ROC 曲线可视化结果。



## 主要发现

### 特征重要性：
肌钙蛋白和 CK-MB 是最重要的预测因子，因为它们是心脏肌肉损伤的直接生物标志物。年龄和血压也有显著贡献。
### 数据质量：
识别并移除异常值（例如，心率 1111）以提高模型可靠性。
### 模型性能：
实现高召回率（约 0.85–0.95，视数据清理而定），优先减少漏诊。
ROC-AUC 分数通常在 0.80–0.90 之间，表明模型具有良好的区分能力。
混淆矩阵显示假阴性较少，这对医疗应用至关重要。


### 挑战：
数据集中可能存在类别不平衡（阳性病例较多），可能影响结果。异常值阈值需要领域专家验证。

## 模型性能

准确率：约 0.85（视数据预处理而定）。
精确率：约 0.80–0.90，表明阳性预测可靠。
召回率：约 0.85–0.95，确保检测到大多数阳性病例。
F1 分数：约 0.85，平衡了精确率和召回率。
ROC-AUC：约 0.80–0.90，显示模型性能优异。
交叉验证：5 折交叉验证召回率平均约 0.90，验证了模型的鲁棒性。

## 潜在改进措施

高级模型：尝试 XGBoost 或梯度提升模型以进一步提高性能。
特征工程：添加交互特征（例如，收缩压/舒张压比率）或对 CK-MB 和肌钙蛋白进行对数变换以处理偏态分布。
类别不平衡：如有需要，应用 SMOTE 等技术处理不平衡数据。
领域验证：与医疗专业人员合作，优化异常值阈值并验证模型预测。
部署：将模型集成到临床决策支持系统中，提供概率输出以提高可解释性。

## 运行方法

安装依赖：pip install pandas numpy scikit-learn matplotlib seaborn。
运行提供的 Python 脚本（heart_attack_prediction.py）以预处理数据、训练模型并可视化结果。
确保数据集（Medicaldataset.csv）位于工作目录中。

## 结论
随机森林模型有效预测心脏病发作结果，肌钙蛋白和 CK-MB 是关键预测因子。高召回率确保了最小的漏诊，这对医疗应用至关重要。未来工作应专注于解决类别不平衡、优化特征工程并与临床专家验证。
